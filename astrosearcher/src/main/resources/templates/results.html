<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css" data-th-href="@{/css/style.css}">
    <title>AstroSearcher</title>
</head>

<body>

<!--
***************************************************
MAST fragment => query by ID + query by coordinates
***************************************************
-->
<div th:fragment="Mast" id="data-MAST" class="tabcontent">

    <label class="data-MSG" th:unless="${containsMAST}" th:text="${mastDataMSG}"></label>
    <th:block th:if="${containsMAST}">
        <div class="data-table">
            <table>
                <thead>
                <tr>
                    <th>#</th>
                    <th:block th:each="field : ${mastFields}">
                        <th th:text="${field}"></th>
                    </th:block>
                </tr>
                </thead>
                <tbody>
                <tr th:each="row, iterStat : ${mastData}">
                    <td th:text="${iterStat.index + 1}"></td>
                    <th:block th:each="field : ${mastFields}"
                              th:with="isEmpty=${row.get(field.getWorkName()) == null ||
                                                 row.get(field.getWorkName()).isJsonNull() ||
                                                 row.get(field.getWorkName()) == ''}">
                        <td th:if="${isEmpty}"></td>
                        <th:block th:unless="${isEmpty}">
                            <td th:if="${field.isIcon()}">
                                <a th:href="${row.get(field.getWorkName()).getAsString()}" target="_blank">
                                    <i th:class="${field.getIconClass()}"></i>
                                </a>
                            </td>
                            <td th:unless="${field.isIcon()}">
                                <span th:if="${row.get(field.getWorkName()).getAsJsonPrimitive().isString()}"
                                      th:text="${row.get(field.getWorkName()).getAsString()}">
                                </span>
                                <span th:unless="${row.get(field.getWorkName()).getAsJsonPrimitive().isString()}"
                                      th:text="${row.get(field.getWorkName())}">
                                </span>
                            </td>
                        </th:block>
                    </th:block>
                </tr>
                </tbody>
            </table>
        </div>
    </th:block>
</div>

<!--
*****************************************************
Simbad fragment => query by ID + query by coordinates
*****************************************************
-->
<div th:fragment="Simbad" id="data-Simbad" class="tabcontent">
    <th:block th:if="${#strings.equals(simbadType, 'SIMBAD_ID')}">
        <div th:replace="results :: Simbad-id"></div>
    </th:block>
    <th:block th:if="${#strings.equals(simbadType, 'SIMBAD_COORDINATES')}">
        <div th:replace="results :: Simbad-coord"></div>
    </th:block>
</div>



<div th:fragment="Vizier" id="data-Vizier" class="tabcontent">
    <label class="data-MSG" th:unless="${containsVizier}" th:text="${vizierDataMSG}"></label>
    <th:block th:if="${containsVizier}" th:each="table : ${vizierTables}">
        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th th:text="${table.getName()}">#</th>
                        <th:block th:each="field : ${table.getFields()}">
                            <th th:text="${field}"></th>
                        </th:block>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="row, iterStat : ${table.getData}">
                        <td th:text="${iterStat.index + 1}"></td>
                        <th:block th:each="column : ${row}">
                            <td th:text="${column}"></td>
                        </th:block>
                    </tr>
                </tbody>
            </table>
        </div>
    </th:block>
</div>

<!--
******************************
Simbad fragment => query by ID
******************************
-->
<div th:fragment="Simbad-id">
    <label class="data-MSG" th:unless="${containsSimbad}" th:text="${simbadDataMSG}"></label>
    <th:block th:if="${containsSimbad}" th:with="data = ${simbadResponse.assignedData.get(0)}">
        <div class="Simbad-general-info padded-grid">
            <div style="grid-row: 1/2; grid-column: 1/3;">  <h3>General information</h3></div>
            <div style="grid-row: 1/2; grid-column: 4/7;">  <h3>Coordinates (ICRS)</h3> </div>
            <div style="grid-row: 1/2; grid-column: 8/11;">
                <h3 th:text="${'Proper Motion ' + data.pmSystem}"></h3>
            </div>

            <div style="grid-row: 2/3; grid-column: 1/2;"><h4>Queried:</h4></div>
            <div style="grid-row: 2/3; grid-column: 2/3;" th:text="${data.queried}"></div>
            <div style="grid-row: 2/3; grid-column: 4/5;"><h4>RA:</h4></div>
            <div style="grid-row: 2/3; grid-column: 5/6;" th:text="${data.ra}"></div>
            <div style="grid-row: 2/3; grid-column: 6/7;" th:text="${simbadResponse.raUnit}"></div>
            <div style="grid-row: 2/3; grid-column: 8/9;"><h4>RA:</h4></div>
            <div style="grid-row: 2/3; grid-column: 9/10;" th:text="${data.pmra}"></div>
            <div style="grid-row: 2/3; grid-column: 10/11;" th:text="${simbadResponse.pmraUnit}"></div>

            <div style="grid-row: 3/4; grid-column: 1/2;"><h4>Main ID:</h4></div>
            <div style="grid-row: 3/4; grid-column: 2/3;">
                <a th:href="@{'/identifiers?id=' + ${data.getMainIdUrlEncoded()}}"
                   th:text="${data.mainID}" target="_blank"></a>
            </div>
            <div style="grid-row: 3/4; grid-column: 4/5;"><h4>Dec:</h4></div>
            <div style="grid-row: 3/4; grid-column: 5/6;" th:text="${data.dec}"></div>
            <div style="grid-row: 3/4; grid-column: 6/7;" th:text="${simbadResponse.decUnit}"></div>
            <div style="grid-row: 3/4; grid-column: 8/9;"><h4>Dec:</h4></div>
            <div style="grid-row: 3/4; grid-column: 9/10;" th:text="${data.pmdec}"></div>
            <div style="grid-row: 3/4; grid-column: 10/11;" th:text="${simbadResponse.pmdecUnit}"></div>

            <div style="grid-row: 4/5; grid-column: 1/2;"><h4>Object type:</h4></div>
            <div style="grid-row: 4/5; grid-column: 2/3;">
                <a th:href="@{${simbadResponse.objectTypeDescLink}}"
                   th:text="${data.objectType}" target="_blank"></a>
            </div>
            <div style="grid-row: 4/5; grid-column: 4/5;"><h4>Error (Major axis):</h4></div>
            <div style="grid-row: 4/5; grid-column: 5/6;" th:text="${data.coordErrorMajA}"></div>
            <div style="grid-row: 4/5; grid-column: 6/7;" th:text="${simbadResponse.coordErrorMajAUnit}"></div>
            <div style="grid-row: 4/5; grid-column: 8/9;"><h4>Error (Major axis):</h4></div>
            <div style="grid-row: 4/5; grid-column: 9/10;" th:text="${data.pmErrorMajA}"></div>

            <div style="grid-row: 5/6; grid-column: 1/2;"><h4>References:</h4></div>
            <div style="grid-row: 5/6; grid-column: 2/3;">
                <a th:href="@{${data.getReferencesUrl()}}"
                   th:text="${data.references}" target="_blank"></a>
            </div>
            <div style="grid-row: 5/6; grid-column: 4/5;"><h4>Error (Minor axis):</h4></div>
            <div style="grid-row: 5/6; grid-column: 5/6;" th:text="${data.coordErrorMinA}"></div>
            <div style="grid-row: 5/6; grid-column: 6/7;" th:text="${simbadResponse.coordErrorMinAUnit}"></div>
            <div style="grid-row: 5/6; grid-column: 8/9;"><h4>Error (Minor axis):</h4></div>
            <div style="grid-row: 5/6; grid-column: 9/10;" th:text="${data.pmErrorMinA}"></div>

            <div style="grid-row: 6/7; grid-column: 4/5;"><h4>Error (Angle):</h4></div>
            <div style="grid-row: 6/7; grid-column: 5/6;" th:text="${data.coordErrorAng}"></div>
            <div style="grid-row: 6/7; grid-column: 6/7;" th:text="${simbadResponse.coordErrorAngUnit}"></div>
            <div style="grid-row: 6/7; grid-column: 8/9;"><h4>Error (Angle):</h4></div>
            <div style="grid-row: 6/7; grid-column: 9/10;" th:text="${data.pmErrorAng}"></div>

            <div style="grid-row: 7/8; grid-column: 1/2;"><h4>Ang. dist:</h4></div>
            <div style="grid-row: 7/8; grid-column: 2/3;" th:text="${data.angularDistance}"></div>
            <div style="grid-row: 7/8; grid-column: 8/9;"><h4>Bibcode:</h4></div>
            <div style="grid-row: 7/8; grid-column: 9/11;">
                <a th:href="@{${data.getPMBibcodeUrl()}}"
                   th:text="${data.pmBibcode}" target="_blank"></a>
            </div>

            <div style="grid-row: 8/11; grid-column: 4/7;">  <h3>Coordinates (Galactic)</h3> </div>

<!--            <th:block th:if="${!#strings.isEmpty(data.angularSizeMajor) || !#strings.isEmpty(data.angularSizeMinor)} ">-->
                <div style="grid-row: 8/9; grid-column: 1/2;"><h4>Ang. size (major, minor):</h4></div>
                <div style="grid-row: 8/9; grid-column: 2/3;"
                     th:text="${data.angularSizeMajor} + ' | ' +  ${data.angularSizeMinor}"></div>

                <div style="grid-row: 9/10; grid-column: 1/2;"><h4>Ang. size (angle):</h4></div>
                <div style="grid-row: 9/10; grid-column: 2/3;" th:text="${data.angularSizeAngle}"></div>
<!--            </th:block>-->

            <div style="grid-row: 10/11; grid-column: 1/2;"><h4></h4>&nbsp;</div>
            <div style="grid-row: 10/11; grid-column: 2/3;">&nbsp;</div>

            <div style="grid-row: 11/12; grid-column: 1/2;"><h4>Spectral type:</h4></div>
            <div style="grid-row: 11/12; grid-column: 2/3;" th:text="${data.spectralType}"></div>
            <div style="grid-row: 11/12; grid-column: 4/5;"><h4>Gal. longitude:</h4></div>
            <div style="grid-row: 11/12; grid-column: 5/6;" th:text="${data.galacticLongitude}"></div>
            <div style="grid-row: 11/12; grid-column: 6/7;" th:text="${simbadResponse.galLongitudeUnit}"></div>

            <div style="grid-row: 12/13; grid-column: 1/2;"><h4>Morphological type:</h4></div>
            <div style="grid-row: 12/13; grid-column: 2/3;" th:text="${data.morphologicalType}"></div>
            <div style="grid-row: 12/13; grid-column: 4/5;"><h4>Gal. latitude:</h4></div>
            <div style="grid-row: 12/13; grid-column: 5/6;" th:text="${data.galacticLatitude}"></div>
            <div style="grid-row: 12/13; grid-column: 6/7;" th:text="${simbadResponse.galLatitudeUnit}"></div>

        </div>
        <div class="fluxes padded-grid">
            <div style="grid-row: 1/2; grid-column: 1/2;">  <h3>Fluxes</h3></div>
            <div style="grid-row: 1/2; grid-column: 3/5;">  <h3>Parallax</h3></div>
            <div style="grid-row: 1/2; grid-column: 6/8;">  <h3>Further Information</h3></div>

            <div style="grid-row: 2/16; grid-column: 1/2;">
                <table>
                    <thead>
                    <tr>
                        <th>Filter</th>
                        <th>Magnitude</th>
                        <th>Error</th>
                        <th>System</th>
                        <th>Bibcode</th>
<!--                        <th>Variability</th>-->
<!--                        <th>Multiplicity</th>-->
                        <th>Quality</th>
<!--                        <th>Unit</th>-->
                    </tr>
                    </thead>
                    <tbody>
                        <tr th:each="flux : ${data.fluxes.values()}">
                            <td th:text="${flux.filter}"></td>
                            <td th:text="${flux.magnitude}"></td>
                            <td th:text="${flux.error}"></td>
                            <td th:text="${flux.system}"></td>
                            <td>
                                <a style="color: midnightblue;"
                                   th:href="@{${flux.getBibcodeUrl()}}"
                                   th:text="${flux.bibcode}" target="_blank"></a>
                            </td>
<!--                            <td th:text="${flux.variabilityFlag}"></td>-->
<!--                            <td th:text="${flux.multiplicityFlag}"></td>-->
                            <td th:text="${flux.qualityFlag}"></td>
<!--                            <td th:text="${flux.unit}"></td>-->
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="grid-row: 2/3; grid-column: 3/4;">Value:</div>
            <div style="grid-row: 2/3; grid-column: 4/5;" th:text="${data.parallaxValue}"></div>
            <div style="grid-row: 2/3; grid-column: 6/7;">Radial velocity:</div>
            <div style="grid-row: 2/3; grid-column: 7/8;" th:text="${data.radialVelocity}"></div>

            <div style="grid-row: 3/4; grid-column: 3/4;">Error:</div>
            <div style="grid-row: 3/4; grid-column: 4/5;" th:text="${data.parallaxError}"></div>
            <div style="grid-row: 3/4; grid-column: 6/7;">Redshift:</div>
            <div style="grid-row: 3/4; grid-column: 7/8;" th:text="${data.redshift}"></div>

            <div style="grid-row: 4/5; grid-column: 3/4;"></div>

            <div style="grid-row: 5/6; grid-column: 3/4;">Observatory code:</div>
            <div style="grid-row: 5/6; grid-column: 4/5;" th:text="${data.parallaxObsCode}"></div>
            <div style="grid-row: 5/6; grid-column: 6/7;">Effective temperature:</div>
            <div style="grid-row: 5/6; grid-column: 7/8;" th:text="${data.effectiveTemperature}"></div>

            <div style="grid-row: 6/7; grid-column: 3/4;">Bibcode:</div>
            <div style="grid-row: 6/7; grid-column: 4/5;">
                <a th:href="@{${data.getParallaxBibcodeUrl()}}"
                   th:text="${data.parallaxBibcode}" target="_blank"></a>
            </div>

            <div style="grid-row: 6/7; grid-column: 3/4;"></div>
            <div style="grid-row: 7/8; grid-column: 3/4;"></div>

            <div style="grid-row: 8/9; grid-column: 6/8;">
                <div style="margin: 0 auto;">
                    <div style="display: inline-block; margin-right: 0.5em; text-align: center;">
                        <a th:href="@{${data.getCDSPortalUrl()}}" target="_blank">
                            <img src="/images/cds_portal-icon.png" style="max-height: 50px;">
                        </a>
                        <br> <b>CDS Portal</b>
                    </div>
                    <div style="display: inline-block; margin-right: 0.5em; text-align: center;">
                        <a th:href="@{${data.getQueryUrl()}}" target="_blank">
                            <img src="/images/simbad_logo.jpg" style="max-height: 50px;">
                        </a>
                        <br> <b>Simbad</b>
                    </div>
                </div>
            </div>
<!--            <div style="grid-row: 7/8; grid-column: 7/8;">-->
<!--                <a th:href="@{${data.getCDSPortalUrl()}}" target="_blank">-->
<!--                    <img src="/images/cds_portal-icon.png">-->
<!--                </a>-->
<!--            </div>-->


        </div>
    </th:block>
</div>

<!--
***************************************
Simbad fragment => query by Coordinates
***************************************
-->
<div th:fragment="Simbad-coord">
        <div class="data-table">
            <table>
                <thead>
                <tr>
                    <th>#</th>
                    <th>Identifier</th>
                    <th>Dist</th>
                    <th>Obj. type</th>
                    <th th:text="${'RA (ICRS, J2000)' + simbadResponse.raUnit}"></th>
                    <th th:text="${'Dec (ICRS, J2000)' + simbadResponse.decUnit}"></th>
                    <th th:text="${'PM - RA' + simbadResponse.pmraUnit}"></th>
                    <th th:text="${'PM - Dec' + simbadResponse.pmdecUnit}"></th>
                    <th>Parallax</th>
<!--                    <th>Rvel/Z</th>-->
                    <th>Redshift</th>
                    <th>Rad. vel.</th>
<!--                    <th>cz</th>-->
                    <th>Mag U</th>
                    <th>Mag B</th>
                    <th>Mag V</th>
                    <th>Mag R</th>
                    <th>Mag G</th>
                    <th>Mag I</th>
                    <th>Mag H</th>
                    <th>Mag J</th>
                    <th>Mag K</th>
                    <th>Mag u</th>
                    <th>Mag g</th>
                    <th>Mag r</th>
                    <th>Mag i</th>
                    <th>Mag z</th>
                    <th>Sp. type.</th>
                    <th>Mor. type</th>
                    <th>Angular size</th>
                    <th>#ref (1850 - now)</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="simbadData, iterStat : ${simbadResponse.assignedData}">
                    <td th:text="${iterStat.index + 1}"></td>
                    <td>
                        <a th:href="@{'/testing?id=' + ${simbadData.getMainIdUrlEncoded()}}" target="_blank"
                           th:text="${simbadData.mainID}"></a>
                    </td>
                    <td th:text="${simbadData.angularDistance}"></td> <!-- DISTANCE (asec) -->
                    <td>
                        <a th:href="@{${simbadResponse.objectTypeDescLink}}"
                           th:text="${simbadData.objectType}" target="_blank"></a>
                    </td>
                    <td th:text="${simbadData.ra}"></td>
                    <td th:text="${simbadData.dec}"></td>
                    <td th:text="${simbadData.pmra}"></td>
                    <td th:text="${simbadData.pmdec}"></td>
                    <td th:text="${simbadData.parallaxValue}"></td>
<!--                    <td></td> &lt;!&ndash; Rvel / Z &ndash;&gt;-->
                    <td th:text="${simbadData.redshift}"></td>
                    <td th:text="${simbadData.radialVelocity}"></td>
<!--                    <td></td> &lt;!&ndash; cz &ndash;&gt;-->
                    <td>
                        <span th:if="${simbadData.getFluxes().containsKey('U')}"
                              th:text="${simbadData.getFluxes().get('U').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('B')}"
                              th:text="${simbadData.fluxes.get('B').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('V')}"
                              th:text="${simbadData.fluxes.get('V').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('R')}"
                              th:text="${simbadData.fluxes.get('R').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('G')}"
                              th:text="${simbadData.fluxes.get('G').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('I')}"
                              th:text="${simbadData.fluxes.get('I').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('H')}"
                              th:text="${simbadData.fluxes.get('H').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('J')}"
                              th:text="${simbadData.fluxes.get('J').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('K')}"
                              th:text="${simbadData.fluxes.get('K').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('u')}"
                              th:text="${simbadData.fluxes.get('u').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('g')}"
                              th:text="${simbadData.fluxes.get('g').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('r')}"
                              th:text="${simbadData.fluxes.get('r').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('i')}"
                              th:text="${simbadData.fluxes.get('i').magnitude}"></span>
                    </td>
                    <td>
                        <span th:if="${simbadData.fluxes.containsKey('z')}"
                              th:text="${simbadData.fluxes.get('z').magnitude}"></span>
                    </td>
                    <td th:text="${simbadData.spectralType}"></td>
                    <td th:text="${simbadData.morphologicalType}"></td>
                    <td th:text="${simbadData.angularSizeMajor + ' | ' +
                                   simbadData.angularSizeMinor + ' | ' +
                                   simbadData.angularSizeAngle}"></td>
                    <td>
                        <a th:href="@{${simbadData.getReferencesUrl()}}"
                           th:text="${simbadData.references}" target="_blank"></a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </th:block>
</div>


</body>
</html>